<?xml version="1.0" encoding="utf-8"?>
<openerp>

    <data>

        <report
                id="fe_invoice"
                string="Factura"
                model="account.invoice"
                report_type="qweb-pdf"
                file="dtm_einvoice_document.fe_invoice_report"
                name="dtm_einvoice_document.fe_invoice_report"
        />


        <template id="fe_invoice_report">
            <t>

                <t t-call="report.html_container">
                    <t t-foreach="docs" t-as="o">

                        <div class="header">
                            <div style="border-top: 1px solid black;">
                                <!--Datos del Emisor-->
                                <table cellspacing="10" width="50%" >
                                    <tr>
                                        <td><span  t-field="o.company_id.logo_web" t-field-options='{"widget": "image"}'/></td>
                                    </tr>
                                    <td><span t-field="o.company_id.name"></span> - <span t-field="o.company_id.street"></span> - <span t-field="o.company_id.city"></span></td>
                                    <tr>
                                    </tr>
                                </table>

                                <table style="empty-cells: hide" cellspacing="10" width="50%" align="right" class="text-right">
                                    <tr>
                                        <th style="border: 1px solid black;text-align: center;" colspan="4">
                                            <b>
                                                <span t-if="o.company_id.vat">RUT EMISOR:
                                                    <t t-set="get_rut_func" t-value="(o.company_id.vat)[2:]"/>
                                                    <t t-esc="get_rut_func"/>
                                                </span>
                                            </b>
                                        </th>
                                    </tr>

                                    <tr>
                                        <td>&#160;</td>
                                    </tr>

                                    <tr>
                                        <th style="border: 1px solid black;text-align: center;" colspan="4"><span t-if="o.type == 'out_invoice' and o.partner_id.vat != '' ">E-FACTURA</span></th>
                                    </tr>
                                    <!--<tr>-->
                                    <!--<td>&#160;</td>-->
                                    <!--<td>&#160;</td>-->
                                    <!--<td>&#160;</td>-->
                                    <!--<td>&#160;</td>-->
                                    <!--</tr>-->
                                    <tr style="border: 1px solid black;">
                                        <td style="border: 1px solid black;text-align: center;">Serie</td>
                                        <td style="border: 1px solid black;text-align: center;">Numero</td>
                                        <td style="border: 1px solid black;text-align: center;">Pago</td>
                                        <td style="border: 1px solid black;text-align: center;">Moneda</td>
                                    </tr>

                                    <tr>
                                        <td style="border: 1px solid black;text-align: center;">
                                            <span t-if="o.fe_Serie"><t t-esc="o.fe_Serie"/></span>
                                        </td>
                                        <td style="border: 1px solid black;text-align: center;">
                                            <span t-if="o.fe_DocNro"><t t-esc="o.fe_DocNro"/></span>
                                        </td>
                                        <td style="border: 1px solid black;text-align: center;">
                                            <span t-if="o.payment_term"><t t-esc="o.payment_term.name"/></span>
                                        </td>
                                        <td style="border: 1px solid black;text-align: center;">
                                            <span t-field="o.currency_id.name"></span> | <span >
                                            <t t-set="get_currency_value" t-value="round(1/(o.currency_id.rate_ids[0].rate),2)"/> <t t-esc="get_currency_value"/></span>
                                        </td>
                                    </tr>
                                    <tr style="border: 1px solid black;text-align: center;">
                                        <th style="border: 1px solid black;text-align: center;" colspan="4"><b><span>RUT COMPRADOR: </span>
                                            <t t-esc="o.partner_id.vat[2:]"/></b></th>
                                    </tr>

                                    <tr style="border: 1px solid black;text-align: center;">
                                        <td tyle="border: 1px solid black;text-align: center;" colspan="4">

                                                <span t-field="o.partner_id.name"></span>
                                                <span t-field="o.partner_id.street"></span>
                                                <span t-field="o.partner_id.city"></span>
                                                 <!--<span t-field="o.partner_id.street">-->
                                                 <!--</span> - <span t-field="o.partner_id.city"></span>&ndash;&gt;-->


                                            <!--<div class="col-xs-5 col-xs-offset-7">-->
                                                <!--<address t-field="o.partner_id"-->
                                                         <!--t-field-options='{"widget": "contact",-->
                                                                           <!--"fields": ["street", "name" ,"city" ], "no_marker": true}'-->
                                                <!--/>-->

                                            <!--</div>-->
                                        </td>
                                    </tr>
                                </table>
                            </div>





                            <!--<table width="100%">-->
                            <!--<tr>-->
                            <!--<td style="border: 1px solid black;">Fecha:<span t-field="o.date_invoice"></span></td>-->
                            <!--</tr>-->
                            <!--</table>-->

                        </div>

                        <div class="page">
                            <div class="row">

                                <table  width="100%" style="font-size:85%;">
                                    <thead>

                                        <tr>
                                            <!--<th style='text-align:center'>Id</th>-->
                                            <th style='text-align:left'>Fecha</th>
                                            <th style='text-align:left'>Concepto</th>
                                            <th style='text-align:right'>Debe</th>
                                            <th style='text-align:right'>Haber</th>
                                            <th style='text-align:right'>Saldo</th>
                                            <th style='text-align:right'>Moneda Origen</th>
                                            <th style='text-align:right'>Importe</th>
                                        </tr>
                                    </thead>
                                    <tbody>


                                    </tbody>
                                </table>

                            </div>
                        </div>

                        <div class="footer">
                            <table cellspacing="10" width="50%">

                                <td>
                                    <span t-if="o.fe_Hash">CÃ³digo de Seguridad:
                                        <t t-set="get_hash" t-value="(o.fe_Hash)[:6]"/>
                                        <t t-esc="get_hash"/>
                                    </span>
                                </td>

                            </table>
                        </div>



                    </t>
                </t>
            </t>
        </template>
    </data>
</openerp>
